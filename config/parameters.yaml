########################################
# Projekt-Parameter (zentral steuerbar)
########################################
parameters:
    memories.index.image_ext: ['jpg','jpeg','jpe','jxl','avif','heic','heif','png','webp','gif','bmp','tiff','tif','cr2','cr3','nef','arw','rw2','raf','dng']
    memories.index.video_ext: []
#    memories.index.video_ext: ['mp4','m4v','mov','3gp','3g2','avi','mkv','webm']
    env(MEMORIES_INDEX_BATCH_SIZE): '25'
    memories.index.batch_size: '%env(int:MEMORIES_INDEX_BATCH_SIZE)%'

    memories.video.poster_frame_second: 1.5
    memories.video.ffmpeg_binary_default: 'ffmpeg'
    memories.video.ffmpeg_path: "%env(default:memories.video.ffmpeg_binary_default:FFMPEG_PATH)%"
    memories.video.ffprobe_binary_default: 'ffprobe'
    memories.video.ffprobe_path: "%env(default:memories.video.ffprobe_binary_default:FFPROBE_PATH)%"

    memories.metadata.pipeline.steps: {}
    memories.metadata.pipeline.telemetry.enabled_default: false
    memories.metadata.pipeline.telemetry.enabled: '%env(default:memories.metadata.pipeline.telemetry.enabled_default:bool:MEMORIES_METADATA_PIPELINE_TELEMETRY)%'

    memories.face_detection.binary_default: ''
    memories.face_detection.binary: "%env(default:memories.face_detection.binary_default:MEMORIES_FACE_DETECTOR_BIN)%"
    memories.face_detection.cascade_default: ''
    memories.face_detection.cascade: "%env(default:memories.face_detection.cascade_default:MEMORIES_FACE_DETECTOR_CASCADE)%"
    memories.face_detection.scale_factor: 1.1
    memories.face_detection.min_neighbors: 4
    memories.face_detection.min_size: 72
    memories.face_detection.timeout: 10.0

    # Hash Defaults
    memories.hash.dct_sample: 32
    memories.hash.lowfreq: 16
    memories.hash.phash_prefix_length: 16

    # Home configuration
    memories.home.lat_default: 0.0
    memories.home.lon_default: 0.0
    memories.home.radius_km_default: 15.0
    memories.home.max_centers_default: 2
    memories.home.fallback_radius_scale_default: 1.75
    env(MEMORIES_HOME_VERSION_HASH): 'home_config_v1'
    memories.home.version_hash: '%env(string:MEMORIES_HOME_VERSION_HASH)%'

    # Geocoding Defaults
    memories.geocoding.nominatim.base_url: '%env(string:NOMINATIM_BASE_URL)%'
    memories.geocoding.nominatim.email:    '%env(string:NOMINATIM_EMAIL)%'
    memories.geocoding.nominatim.user_agent: 'Rueckblick/1.0'
    memories.geocoding.nominatim.zoom: 14
    memories.geocoding.delay_ms: 1200
    memories.geocoding.refresh.batch_size: 25
    memories.geocoding.overpass.base_url: 'https://overpass-api.de/api'
    memories.geocoding.overpass.timeout: 25
    memories.geocoding.overpass.radius_m: 250
    memories.geocoding.overpass.max_pois: 15
    memories.geocoding.overpass.fetch_limit_multiplier: 3.0
    memories.geocoding.overpass.allowed_pois: []
    memories.localization.preferred_locale_default: 'de'
    memories.localization.preferred_locale: '%env(default:memories.localization.preferred_locale_default:string:MEMORIES_PREFERRED_LOCALE)%'

    memories.timezone.default: 'UTC'
    memories.cluster.timezone.default: 'Europe/Berlin'
    memories.time.normalizer.source_priority: ['filename','file_mtime']
    memories.time.normalizer.max_offset_minutes_default: 720
    memories.time.normalizer.max_offset_minutes: '%env(default:memories.time.normalizer.max_offset_minutes_default:int:MEMORIES_TIME_NORMALIZER_MAX_OFFSET_MINUTES)%'

    memories.cluster.transport_speed.min_leg_duration_minutes_default: 5.0
    memories.cluster.transport_speed.min_leg_distance_km_default: 10.0
    memories.cluster.transport_speed.high_speed_threshold_kmh_default: 160.0
    memories.cluster.transport_speed.min_leg_duration_minutes: '%env(default:memories.cluster.transport_speed.min_leg_duration_minutes_default:float:MEMORIES_CLUSTER_TRANSPORT_MIN_LEG_MINUTES)%'
    memories.cluster.transport_speed.min_leg_distance_km: '%env(default:memories.cluster.transport_speed.min_leg_distance_km_default:float:MEMORIES_CLUSTER_TRANSPORT_MIN_LEG_DISTANCE_KM)%'
    memories.cluster.transport_speed.high_speed_threshold_kmh: '%env(default:memories.cluster.transport_speed.high_speed_threshold_kmh_default:float:MEMORIES_CLUSTER_TRANSPORT_HIGH_SPEED_THRESHOLD_KMH)%'

    memories.cluster.cohort.important_person_ids: []
    memories.cluster.cohort.fallback_person_ids: []

    # Thumbnail-Größen (px)
    memories.thumbnail_sizes: [320, 1024]
    memories.thumbnail.apply_orientation_default: false
    memories.thumbnail.apply_orientation: '%env(default:memories.thumbnail.apply_orientation_default:bool:MEMORIES_THUMBNAIL_APPLY_ORIENTATION)%'

    # Consolidation Defaults
    memories.cluster.consolidate.min_score: 0.30
    memories.cluster.consolidate.min_size: 3
    memories.cluster.consolidate.overlap_merge_threshold: 0.50
    memories.cluster.consolidate.overlap_drop_threshold: 0.70
    memories.cluster.consolidate.per_media_cap: 2
    memories.cluster.consolidate.keep_order:
        - 'vacation'
        - 'hike_adventure'
        - 'transit_travel_day'
        - 'significant_place'
        - 'first_visit_place'
        - 'location_similarity'
        - 'cross_dimension'
        - 'person_cohort'
        - 'holiday_event'
        - 'new_year_eve'
        - 'anniversary'
        - 'nightlife_event'
        - 'cityscape_night'
        - 'on_this_day_over_years'
        - 'one_year_ago'
        - 'weekend_getaways_over_years'
        - 'snow_vacation_over_years'
        - 'season_over_years'
        - 'this_month_over_years'
        - 'year_in_review'
        - 'monthly_highlights'
        - 'season'
        - 'golden_hour'
        - 'snow_day'
        - 'day_album'
        - 'at_home_weekend'
        - 'at_home_weekday'
        - 'time_similarity'
        - 'photo_motif'
        - 'panorama'
        - 'panorama_over_years'
        - 'portrait_orientation'
        - 'video_stories'
        - 'device_similarity'
        - 'phash_similarity'
        - 'burst'
    memories.cluster.consolidate.classification_priority:
        vacation:
            - 'vacation'
            - 'short_trip'
            - 'day_trip'
    memories.cluster.consolidate.default_group: 'default'
    memories.cluster.consolidate.groups:
        time_similarity: 'time_and_basics'
        day_album: 'time_and_basics'
        monthly_highlights: 'time_and_basics'
        year_in_review: 'time_and_basics'
        this_month_over_years: 'time_and_basics'
        on_this_day_over_years: 'time_and_basics'
        one_year_ago: 'time_and_basics'
        location_similarity: 'travel_and_places'
        vacation: 'travel_and_places'
        weekend_getaways_over_years: 'travel_and_places'
        transit_travel_day: 'travel_and_places'
        significant_place: 'travel_and_places'
        first_visit_place: 'travel_and_places'
        at_home_weekday: 'home'
        at_home_weekend: 'home'
        season: 'nature_and_seasons'
        season_over_years: 'nature_and_seasons'
        snow_day: 'nature_and_seasons'
        snow_vacation_over_years: 'nature_and_seasons'
        hike_adventure: 'nature_and_seasons'
        cityscape_night: 'city_and_events'
        nightlife_event: 'city_and_events'
        holiday_event: 'city_and_events'
        new_year_eve: 'city_and_events'
        golden_hour: 'city_and_events'
        person_cohort: 'people_and_moments'
        anniversary: 'people_and_moments'
        photo_motif: 'motifs_and_formats'
        panorama: 'motifs_and_formats'
        panorama_over_years: 'motifs_and_formats'
        portrait_orientation: 'motifs_and_formats'
        video_stories: 'motifs_and_formats'
        burst: 'similarity_algorithms'
        device_similarity: 'similarity_algorithms'
        phash_similarity: 'similarity_algorithms'
        cross_dimension: 'similarity_algorithms'
    memories.cluster.consolidate.annotate_only:
        - 'phash_similarity'
        - 'burst'
    memories.cluster.consolidate.min_unique_share:
        photo_motif: 0.25
        device_similarity: 0.40
        panorama: 0.25
        portrait_orientation: 0.25
        video_stories: 0.25
    memories.cluster.consolidate.require_valid_time: true
    memories.cluster.consolidate.min_valid_year: 1990
    memories.cluster.persistence.max_members: '%env(int:MEMORIES_CLUSTER_MAX_MEMBERS)%'

    # Cluster Strategy Priorities
    # Higher numbers run earlier; values normalized to an evenly spaced 40-100 range.
    memories.cluster.priority.this_month_over_years_cluster_strategy: 100
    memories.cluster.priority.phash_similarity_strategy: 99
    memories.cluster.priority.burst_cluster_strategy: 98
    memories.cluster.priority.vacation_cluster_strategy: 96
    memories.cluster.priority.transit_travel_day_cluster_strategy: 94
    memories.cluster.priority.first_visit_place_cluster_strategy: 91
    memories.cluster.priority.significant_place_cluster_strategy: 89
    memories.cluster.priority.location_similarity_strategy: 88
    memories.cluster.priority.person_cohort_cluster_strategy: 87
    memories.cluster.priority.holiday_event_cluster_strategy: 86
    memories.cluster.priority.new_year_eve_cluster_strategy: 85
    memories.cluster.priority.cityscape_night_cluster_strategy: 81
    memories.cluster.priority.nightlife_event_cluster_strategy: 80
    memories.cluster.priority.hike_adventure_cluster_strategy: 79
    memories.cluster.priority.cross_dimension_cluster_strategy: 75
    memories.cluster.priority.on_this_day_over_years_cluster_strategy: 74
    memories.cluster.priority.one_year_ago_cluster_strategy: 73
    memories.cluster.priority.anniversary_cluster_strategy: 72
    memories.cluster.priority.snow_vacation_over_years_cluster_strategy: 68
    memories.cluster.priority.season_over_years_cluster_strategy: 66
    memories.cluster.priority.weekend_getaways_over_years_cluster_strategy: 64
    memories.cluster.priority.year_in_review_cluster_strategy: 62
    memories.cluster.priority.monthly_highlights_cluster_strategy: 61
    memories.cluster.priority.season_cluster_strategy: 60
    memories.cluster.priority.golden_hour_cluster_strategy: 59
    memories.cluster.priority.snow_day_cluster_strategy: 56
    memories.cluster.priority.day_album_cluster_strategy: 54
    memories.cluster.priority.time_similarity_strategy: 51
    memories.cluster.priority.photo_motif_cluster_strategy: 48
    memories.cluster.priority.panorama_cluster_strategy: 47
    memories.cluster.priority.panorama_over_years_cluster_strategy: 46
    memories.cluster.priority.portrait_orientation_cluster_strategy: 45
    memories.cluster.priority.at_home_weekend_cluster_strategy: 44
    memories.cluster.priority.at_home_weekday_cluster_strategy: 42
    memories.cluster.priority.video_stories_cluster_strategy: 41
    memories.cluster.priority.device_similarity_strategy: 40

    # Scoring Defaults
    memories.score.quality_baseline_megapixels: 12.0
    memories.score.quality.min_resolution_megapixels: 2.0
    memories.score.quality.low_score_threshold: 0.35
    memories.score.quality.low_sharpness_threshold: 0.20
    memories.score.quality.low_exposure_threshold: 0.25
    memories.score.quality.low_noise_quality_threshold: 0.25
    memories.score.quality.clipping_threshold: 0.15
    memories.score.quality.clipping_penalty_weight: 0.5
    memories.score.min_valid_year: 1995
    memories.score.time_range.min_samples: 3
    memories.score.time_range.min_coverage: 0.6
    memories.score.poi_category_boosts:
        'tourism/*': 0.20
        'tourism/museum': 0.30
        'tourism/gallery': 0.22
        'tourism/theme_park': 0.25
        'leisure/park': 0.14
        'leisure/playground': 0.12
        'amenity/restaurant': 0.08
        'amenity/cafe': 0.06
        'historic/*': 0.18
        'historic/castle': 0.22
        'natural/beach': 0.20
        'natural/viewpoint': 0.12
        'shop/mall': 0.06

    # Feed Defaults
    memories.feed.min_score: 0.35
    memories.feed.min_members: 4
    memories.feed.max_per_day: 6
    memories.feed.max_total: 60
    memories.feed.max_per_algorithm: 12
    memories.feed.preferences_path: '%kernel.project_dir%/var/feed-preferences.json'
    memories.feed.quality_floor: 0.30
    memories.feed.people_coverage_min: 0.25
    memories.feed.recent_days: 30
    memories.feed.stale_days: 365
    memories.feed.recent_score_bonus: 0.03
    memories.feed.stale_score_penalty: 0.05

    memories.feed.personalization.profiles:
        default:
            min_score: '%memories.feed.min_score%'
            min_members: '%memories.feed.min_members%'
            max_per_day: '%memories.feed.max_per_day%'
            max_total: '%memories.feed.max_total%'
            max_per_algorithm: '%memories.feed.max_per_algorithm%'
            quality_floor: '%memories.feed.quality_floor%'
            people_coverage_min: '%memories.feed.people_coverage_min%'
            recent_days: '%memories.feed.recent_days%'
            stale_days: '%memories.feed.stale_days%'
            recent_score_bonus: '%memories.feed.recent_score_bonus%'
            stale_score_penalty: '%memories.feed.stale_score_penalty%'
        familienfreundlich:
            min_score: 0.32
            min_members: 3
            max_per_day: 8
            max_total: 80
            max_per_algorithm: 14
            quality_floor: 0.28
            people_coverage_min: 0.20
            recent_days: 14
            stale_days: 120
            recent_score_bonus: 0.05
            stale_score_penalty: 0.04
        reisen:
            min_score: 0.38
            min_members: 4
            max_per_day: 5
            max_total: 48
            max_per_algorithm: 10
            quality_floor: 0.34
            people_coverage_min: 0.18
            recent_days: 21
            stale_days: 240
            recent_score_bonus: 0.04
            stale_score_penalty: 0.06

    memories.http.feed.default_limit: 24
    memories.http.feed.max_limit: 120
    memories.http.feed.preview_images: 20
    memories.http.feed.cluster_multiplier: 4
    memories.http.feed.cover_width: 640
    memories.http.feed.member_width: 320
    memories.http.feed.max_thumbnail_width: 2048

    memories.slideshow.video_dir: '%env(string:MEMORIES_SLIDESHOW_DIR)%'
    memories.slideshow.image_duration_s: 3.5
    memories.slideshow.transition_duration_s: 0.8
    memories.slideshow.video_width: 1280
    memories.slideshow.video_height: 720
    memories.slideshow.ffmpeg_path: 'ffmpeg'
    memories.slideshow.php_binary_default: 'php'
    memories.slideshow.php_binary: "%env(default:memories.slideshow.php_binary_default:MEMORIES_PHP_BINARY)%"
    memories.slideshow.transitions:
        - 'fade'
        - 'wipeleft'
        - 'wiperight'
        - 'circleopen'
        - 'circleclose'
        - 'pixelize'
    memories.slideshow.music_path_default: ''
    memories.slideshow.music_path: "%env(default:memories.slideshow.music_path_default:MEMORIES_SLIDESHOW_MUSIC)%"
