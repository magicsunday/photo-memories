# Metadatenanforderungen der Cluster-Strategien

Diese Übersicht fasst für jede Strategie im Verzeichnis `src/Clusterer/` zusammen, welche Metadatenfelder während der Laufzeit benötigt werden und aus welchen Extraktionsstufen die Daten stammen. Die Hinweise helfen dabei, beim Indexlauf die richtigen Stages aus `config/services.yaml` zu aktivieren.

| Strategie | Benötigte Metadatenfelder | Relevante Extraktoren / Index-Stages |
| --- | --- | --- |
| Anniversary (`AnniversaryClusterStrategy`) | – Aufnahmezeit (`takenAt`) für die Tageszuordnung<br>– GPS-Koordinaten sowie mehrheitlicher Ortsname für Zentroid & Label<br>– Szenentags und manuelle Keywords für die Tag-Zusammenfassung | – `ExifMetadataExtractor`, `FileStatMetadataExtractor`, `AppleHeuristicsExtractor` & `TimeNormalizer` (Metadata- & Time-Stage)<br>– `ExifMetadataExtractor` (GPS) + `GeoFeatureEnricher` inkl. Nominatim/Overpass (Geo-Stage)<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor` (Scene- & Metadata-Stage) |
| At home (Woche/Weekend) (`AtHomeWeekdayClusterStrategy`, `AtHomeWeekendClusterStrategy`) | – Aufnahmezeit inkl. lokaler Zeitzone (`capturedLocal`/`timezoneOffsetMin`)<br>– GPS-Koordinaten, Entfernung zum Home-Point und Home-Config-Hash<br>– Kalender-Features (Wochenende, Feiertag) für Parameter<br>– Szenentags & Keywords für Kontextbeschreibung<br>– Qualitäts- und Personenmetriken für Scoring/Feed | – `ExifMetadataExtractor` + `FileStatMetadataExtractor` + `TimeNormalizer` (Time-Stage) für Zeit & Zeitzone<br>– `GeoFeatureEnricher` (Geo-Stage) für Distanz/Home-Metadaten und Ortslabel<br>– `CalendarFeatureEnricher` (Time-Stage)<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor` (Scene/Metadata)<br>– `VisionSignatureExtractor` & `MediaQualityAggregator` (Quality-Stage) |
| Burst (`BurstClusterStrategy`) | – Aufnahmezeit & GPS für Serienheuristik<br>– Burst-Metadaten (`burstUuid`, `burstIndex`, `isBurstRepresentative`)<br>– Ortslabel + POI-Zusammenfassung<br>– Szenentags/Keywords | – `ExifMetadataExtractor`/`TimeNormalizer` (Zeit) + `GeoFeatureEnricher` (Ort)<br>– `BurstIndexExtractor`, `BurstDetector`, `LivePairLinker` (Burst-Live-Stage)<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor` |
| Cross Dimension (`CrossDimensionClusterStrategy`) | – Aufnahmezeit & GPS zur Laufzeitgruppenbildung<br>– Szenentags/Keywords<br>– Qualitätskennzahlen (Auflösung, Schärfe, ISO, Belichtung, Farbe) | – `ExifMetadataExtractor` + `TimeNormalizer` + `GeoFeatureEnricher`<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor`<br>– `VisionSignatureExtractor` & `MediaQualityAggregator`, ISO aus `ExifMetadataExtractor` (Quality-Stage) |
| Day Album (`DayAlbumClusterStrategy`) | – Aufnahmezeit & lokale Tagesgrenzen (`LocalTimeHelper`)<br>– GPS & Ortslabel<br>– Kalenderfeatures (Wochenende/Feiertag)<br>– Qualitätswerte<br>– Szenentags/Keywords | – `ExifMetadataExtractor`, `FileStatMetadataExtractor`, `TimeNormalizer`<br>– `GeoFeatureEnricher` (Ort)<br>– `CalendarFeatureEnricher` (Wochenende/Feiertag)<br>– `VisionSignatureExtractor` & `MediaQualityAggregator`<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor` |
| Device Similarity (`DeviceSimilarityStrategy`) | – Aufnahmezeit (Sortierung)<br>– Kameradaten (`cameraMake`, `cameraModel`, `cameraOwner`, `cameraBodySerial`, `lensModel`)<br>– Content-Klassifizierung (`contentKind`)<br>– Ortslabel/GPS für Kontext | – `ExifMetadataExtractor` (Zeit, Kamera- & Objektivdaten)<br>– `ContentClassifierExtractor` (Content-Stage)<br>– `GeoFeatureEnricher` + Nominatim/Overpass (Ort) |
| First Visit Place (`FirstVisitPlaceClusterStrategy`) | – Aufnahmezeit (inkl. lokaler Zeitzone) <br>– GPS-Koordinaten<br>– Ortslabel | – `ExifMetadataExtractor` + `TimeNormalizer` (Zeit)<br>– `GeoFeatureEnricher` für Koordinaten & Label |
| Golden Hour (`GoldenHourClusterStrategy`) | – Aufnahmezeit & lokaler Tag (Solarfenster)<br>– Golden-Hour-Feature (`features['solar']['isGoldenHour']`)<br>– Szenentags mit Sonnenauf-/untergang-Bezug<br>– GPS für Zentroid | – `ExifMetadataExtractor`, `TimeNormalizer`<br>– `SolarEnricher` (Time-Stage) für Golden-Hour-Flag<br>– `ClipSceneTagExtractor` (Scene-Stage) |
| Holiday Event (`HolidayEventClusterStrategy`) | – Aufnahmezeit<br>– Kalenderfeatures `isHoliday`/`holidayId`<br>– Ortslabel & POI<br>– Szenentags/Keywords | – `ExifMetadataExtractor`, `TimeNormalizer`<br>– `CalendarFeatureEnricher` (Holiday-Erkennung)<br>– `GeoFeatureEnricher` + LocationHelper<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor` |
| Location Similarity (`LocationSimilarityStrategy`) | – Aufnahmezeit<br>– Ortscluster (`localityKey`, `GeoCell8`), POI-Kontext<br>– GPS-Koordinaten<br>– Szenentags/Keywords | – `GeoFeatureEnricher` (Geo-Stage) inkl. Geohashes & POI-Analyse<br>– `ExifMetadataExtractor` + `TimeNormalizer` (Zeit)<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor` |
| Monthly Highlights (`MonthlyHighlightsClusterStrategy`) | – Aufnahmezeit (auf Monat normiert)<br>– GPS & Ortslabel<br>– Szenentags/Keywords | – `ExifMetadataExtractor`, `TimeNormalizer`<br>– `GeoFeatureEnricher`<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor` |
| New Year’s Eve (`NewYearEveClusterStrategy`) | – Aufnahmezeit inkl. lokaler Zeitfenster<br>– GPS & Ortslabel/POI | – `ExifMetadataExtractor`, `TimeNormalizer`<br>– `GeoFeatureEnricher` + LocationHelper |
| Nightlife Event (`NightlifeEventClusterStrategy`) | – Aufnahmezeit & lokaler Tag<br>– GPS & Ortslabel/POI<br>– Daypart-Feature (`features['calendar']['daypart'] === 'night'`)<br>– Szenentags mit Nacht-/Partybezug | – `ExifMetadataExtractor`, `TimeNormalizer`<br>– `GeoFeatureEnricher` (POI-Kontext)<br>– `DaypartEnricher` (Time-Stage)<br>– `ClipSceneTagExtractor` |
| On This Day Over Years (`OnThisDayOverYearsClusterStrategy`) | – Aufnahmezeit (lokal)<br>– GPS & Ortslabel<br>– Szenentags/Keywords | – `ExifMetadataExtractor`, `TimeNormalizer`<br>– `GeoFeatureEnricher`<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor` |
| One Year Ago (`OneYearAgoClusterStrategy`) | – Aufnahmezeit (lokal, Vergleichsfenster)<br>– GPS & Ortslabel<br>– Szenentags/Keywords | – `ExifMetadataExtractor`, `TimeNormalizer`<br>– `GeoFeatureEnricher`<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor` |
| Panorama (`PanoramaClusterStrategy`) | – Aufnahmezeit<br>– Panorama-Flag bzw. Bilddimensionen (`width`/`height`)<br>– GPS für Zentroid | – `ExifMetadataExtractor` inkl. `AspectFlagExifMetadataProcessor`<br>– `FilenameKeywordExtractor` (Panorama-Heuristik)<br>– `TimeNormalizer`, `GeoFeatureEnricher` |
| Panorama Over Years (`PanoramaOverYearsClusterStrategy`) | – Aufnahmezeit<br>– Panorama-Flag / Bilddimensionen | – wie oben: `ExifMetadataExtractor` + `FilenameKeywordExtractor` + `TimeNormalizer` |
| Person Cohort (`PersonCohortClusterStrategy`) | – Aufnahmezeit<br>– Personen-IDs/-Namen (`getPersons`, `PersonTaggedMediaInterface`)<br>– Gesichtsindikator | – `XmpIptcExtractor` (Personentags)<br>– `FacePresenceDetector` bzw. Apple-Heuristiken für Gesichter<br>– `ExifMetadataExtractor`, `TimeNormalizer` |
| pHash Similarity (`PhashSimilarityStrategy`) | – Aufnahmezeit<br>– Perzeptueller Hash (`phash`)<br>– Ortslabel/GPS | – `PerceptualHashExtractor` (Hash-Stage)<br>– `ExifMetadataExtractor`, `TimeNormalizer`<br>– `GeoFeatureEnricher` |
| Portrait Orientation (`PortraitOrientationClusterStrategy`) | – Aufnahmezeit<br>– Portrait-Flag / Bilddimensionen<br>– Gesichts-/Personenerkennung zur Filterung | – `ExifMetadataExtractor` + `AspectFlagExifMetadataProcessor`<br>– `FacePresenceDetector`, `XmpIptcExtractor` (Personen)<br>– `TimeNormalizer`, `GeoFeatureEnricher` |
| Season (`SeasonClusterStrategy`) | – Aufnahmezeit<br>– Kalenderfeature `season`, Wochenende/Feiertag<br>– GPS & Ortslabel<br>– Qualitätsmetriken<br>– Szenentags/Keywords | – `CalendarFeatureEnricher` (Season, Holiday), `TimeNormalizer`<br>– `GeoFeatureEnricher`<br>– `VisionSignatureExtractor` & `MediaQualityAggregator`<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor` |
| Season Over Years (`SeasonOverYearsClusterStrategy`) | – Aufnahmezeit<br>– Kalenderfeature `season`<br>– GPS & Ortslabel<br>– Szenentags/Keywords | – `CalendarFeatureEnricher`, `TimeNormalizer`<br>– `GeoFeatureEnricher`<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor` |
| Significant Place (`SignificantPlaceClusterStrategy`) | – Aufnahmezeit<br>– GPS-Koordinaten & Geogrid (`gridDegrees`)<br>– Ortslabel & POI | – `ExifMetadataExtractor`, `TimeNormalizer`<br>– `GeoFeatureEnricher` (inkl. POI-Kontext) |
| This Month Over Years (`ThisMonthOverYearsClusterStrategy`) | – Aufnahmezeit (lokal)<br>– GPS & Ortslabel<br>– Szenentags/Keywords | – `ExifMetadataExtractor`, `TimeNormalizer`<br>– `GeoFeatureEnricher`<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor` |
| Time Similarity (`TimeSimilarityStrategy`) | – Aufnahmezeit<br>– Ortscluster (`localityKey`)<br>– GPS<br>– Szenentags/Keywords | – `ExifMetadataExtractor`, `TimeNormalizer`<br>– `GeoFeatureEnricher` (Locality Keys)<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor` |
| Transit Travel Day (`TransitTravelDayClusterStrategy`) | – Aufnahmezeit & lokaler Tag<br>– GPS-Koordinaten zur Distanzberechnung<br>– Ortslabel & POI | – `ExifMetadataExtractor`, `TimeNormalizer`<br>– `GeoFeatureEnricher` (inkl. Distanz & POI) |
| Vacation (`VacationClusterStrategy` inkl. DaySummary-Stages) | – Aufnahmezeit & Zeitzoneninformationen (`TimezoneResolver`)<br>– GPS, Geodistanzen & Home-Berechnung<br>– POI/Ortsdaten inkl. Länder-Codes<br>– Tagesdichte, Staypoints, Away-Flags etc. aus DaySummary-Stages | – Kombination aller Kernstages: `ExifMetadataExtractor`, `FileStatMetadataExtractor`, `TimeNormalizer`, `CalendarFeatureEnricher`, `DaypartEnricher`, `SolarEnricher` (Zeitfeatures)<br>– `GeoFeatureEnricher` + Nominatim/Overpass (Ort/POI, Distanz, Home-Radius)<br>– DaySummary-spezifische Services wie `GpsMetricsStage`, `DensityStage`, `AwayFlagStage`, `BaseLocationResolver`, `PoiClassifier` |
| Video Stories (`VideoStoriesClusterStrategy`) | – Aufnahmezeit & lokaler Tag<br>– Videoflag (`isVideo`/MIME) und Laufzeit (`videoDurationS`)<br>– Slow-Motion/Stabilisation<br>– GPS & Ortslabel<br>– Szenentags/Keywords<br>– Geräteprofil (Make/Model/Owner/Serial/Lens, ContentKind) | – `FfprobeMetadataExtractor` (Videoattribute), `MimeDetectionStage`<br>– `ExifMetadataExtractor`, `TimeNormalizer`<br>– `GeoFeatureEnricher`<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor`<br>– `CompositeMetadataExtractor` (Kamera/Lens-Felder) |
| Weekend Getaways Over Years (`WeekendGetawaysOverYearsClusterStrategy`) | – Aufnahmezeit & lokale Tagesgrenzen<br>– Ortscluster (`localityKeyForMedia`) + GPS<br>– Kalenderfeatures (Wochenende)<br>– POI/Label zur Bewertung der Aufenthaltswechsel | – `ExifMetadataExtractor`, `TimeNormalizer`<br>– `GeoFeatureEnricher` + LocationHelper<br>– `CalendarFeatureEnricher` (Wochenende) |
| Year In Review (`YearInReviewClusterStrategy`) | – Aufnahmezeit<br>– GPS & Ortslabel<br>– Szenentags/Keywords | – `ExifMetadataExtractor`, `TimeNormalizer`<br>– `GeoFeatureEnricher`<br>– `ClipSceneTagExtractor`, `XmpIptcExtractor`, `FilenameKeywordExtractor` |

> **Hinweis:** Strategien, die Zentroid- oder Ortslabels erzeugen, profitieren nur dann von hochwertigen Ergebnissen, wenn neben dem EXIF-GPS auch die Geocoding-Stufe (`GeoFeatureEnricher` mit Nominatim/Overpass) aktiv ist. Für Person-bezogene Cluster sollten außerdem sowohl `XmpIptcExtractor` als auch `FacePresenceDetector` laufen, damit vorhandene Markierungen und automatisch erkannte Gesichter berücksichtigt werden.
